flowchart TD
    Start(["User Input: Buy 10 ETH"]) --> LLM{LLM: Generate with Tools}

    LLM -->|Text Response| Output(["Response to User"])
    LLM -->|ToolCall| Extract["Extract Arguments: symbol='ETH', side='buy', qty=10"]
    
    Extract --> Tool["Call Tool: execute_trade"]

    subgraph "Tool Execution (Sync -> Async Bridge)"
        Tool --> Init["Init UnitOfWork & Adapter"]
        Init --> Fetch["Fetch Current Price"]
        Fetch --> CreateDTO["Create OrderDTO"]
        CreateDTO --> Commit["UseCase.execute() -> DB Commit"]
    end

    Commit --> Return["Return Order ID"]
    Return --> Output
